.agenda-admin
  %h3 Agenda admin

  %table.agenda-select(border="1")
    %tr
      %td Create a new agenda
      %td
        %input.title(ng-model="new_agenda.title"){placeholder: 'Enter title for new agenda (min 10 characters)'}
      %td
        %button.btn-primary.btn(ng-click="create_agenda()" ng-disabled="!new_agenda.title || new_agenda.title.length<10"){type: 'button'}
          %span.def-msg Create a new agenda
          %span.busy-msg
            Building
            %i.fa.fa-spinner.fa-spin
    %tr
      %td Edit an existing agenda
      %td
        %select(ng-model="select_agenda" ng-options="agenda.title.substring(0,100) for agenda in agendas")
          %option(value="" disabled selected) Select an agenda

      %td
        %button.btn-primary.btn(ng-click="edit_agenda()"){type: 'submit'}
          %span.def-msg Edit agenda
          %span.busy-msg
            Building
            %i.fa.fa-spinner.fa-spin

  %div(ng-if="agenda")
    %h3 Agenda details and actions
    %table(border="1")
      %tr
        %td Title
        %td
          %p(click-to-edit="agenda.title" code="agenda.code" inp-type="'text'" func="update_agenda_title(code, str)") {{agenda.title}}
      %tr
        %td Description
        %td
          %p(click-to-edit="agenda.description" code="agenda.code" inp-type="'textarea'" func="update_agenda_description(code, str)") {{agenda.description}}

      %tr
        %td URL
        %td
          %a(href="{{agenda.url}}" target="_blank") {{agenda.url}}

      %tr
        %td Test mode
        %td
          <div btn-switch ng-model="agenda.test_mode" onchange="update_test"></div>
      %tr
        %td List publicly
        %td
          <div btn-switch ng-model="agenda.list" onchange="update_list"></div>
      %tr
        %td
          Actions
        %td
          %a(href="/api/agendas/{{agenda.code}}/export.yaml")
            %button.btn-primary.btn.btn-sm{type: 'button'}
              %span.def-msg Export
              %span.busy-msg
                Exporting
                %i.fa.fa-spinner.fa-spin

          %button.btn-primary.btn.btn-sm(ng-click="refresh_agenda()"){type: 'submit'}
            %span.def-msg Refresh menus
            %span.busy-msg
              Refreshing
              %i.fa.fa-spinner.fa-spin
      %tr
        %td.warn
          Destructive action!
        %td
          %button.btn-primary.btn.btn-sm(ng-click="reset_agenda()" ng-disabled="agenda.test_mode==false"){type: 'submit'}
            %span.def-msg Reset agenda
            %span.busy-msg
              Resetting
              %i.fa.fa-spinner.fa-spin
          %span(ng-if="agenda.test_mode==false") Agenda cannot be reset unless agenda is in test mode
      %tr
        %td.warn
          Destructive action!
        %td
          %button.btn-primary.btn.btn-sm(ng-click="delete_agenda()" ng-disabled="agenda.test_mode==false"){type: 'submit'}
            %span.def-msg Delete agenda
            %span.busy-msg
              Deleting
              %i.fa.fa-spinner.fa-spin
          %span(ng-if="agenda.test_mode==false") Agenda cannot be deleted unless agenda is in test mode

    -#%table(border="1")
      %tr
        %th id
        %th x
        %th y
        %th w
        %th h
      %tr
        %td upper
        %td {{placeholder_upper.x}}
        %td {{placeholder_upper.y}}
        %td {{placeholder_upper.w}}
        %td {{placeholder_upper.h}}
      %tr
        %td middle
        %td {{placeholder.x}}
        %td {{placeholder.y}}
        %td {{placeholder.w}}
        %td {{placeholder.h}}
      %tr
        %td lower
        %td {{placeholder_lower.x}}
        %td {{placeholder_lower.y}}
        %td {{placeholder_lower.w}}
        %td {{placeholder_lower.h}}

    %p Positioning: scrollTop: {{pos.scrollTop}}, mouseY: {{pos.eY}}, initialMouseY: {{pos.iMY}}, initElemY: {{pos.iEY}}, dragged.y: {{pos.dragY}}. offsetY: {{pos.offsetY}}, par_top: {{pos.par_top}}, par_bottom: {{pos.par_bottom}}

    %h3 Agenda's deliberations
    .conversation-admin
      .conversations
        .row.list(ng-repeat="conversation in agenda.conversations" ce-sort func="update_conversations_order(code, ids)" code="agenda.code"){id: "{{conversation.id}}"}
          .col-sm-9{id: "{{conversation.id}}"}
            %p(click-to-edit="conversation.title" code="conversation.code" inp-type="'text'" func="update_conversation_title(code, str)") {{conversation.title}}
          .col-sm-3
            Controls
    .row
      .col-sm-2 Add a new conversation
      .col-sm-7
        %input.title(ng-model="new_conversation.title"){placeholder: 'Enter title for new conversation (min 10 characters)'}
      .col-sm-3
        %button.btn-primary.btn(ng-click="add_conversation()" ng-disabled="!new_conversation.title || new_conversation.title.length<10"){type: 'button'}
          %span.def-msg Add conversation
          %span.busy-msg
            Adding
            %i.fa.fa-spinner.fa-spin

    %h3 Agenda MCA
    %table(border="1")
      %tr
        %td Title
        %td {{agenda.title}}

    %h3 Agenda participants
    %table(border="1")
      %tr
        %td Title
        %td {{agenda.title}}